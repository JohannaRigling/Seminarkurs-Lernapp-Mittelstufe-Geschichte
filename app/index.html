<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HistoLearn - Geschichte Lernapp</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/themes.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="screen active">
        <div class="login-container">
            <div class="login-header">
                <div class="castle-icon">ğŸ°</div>
                <h1>HistoLearn</h1>
                <p>Dein Weg durch die Geschichte</p>
            </div>

            <div class="login-box">
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="showLoginTab('login')">Anmelden</button>
                    <button class="tab-btn" onclick="showLoginTab('register')">Registrieren</button>
                </div>

                <form id="loginForm" class="auth-form active" onsubmit="handleLogin(event)">
                    <div class="input-group">
                        <label>Benutzername</label>
                        <input type="text" id="loginUsername" required>
                    </div>
                    <div class="input-group">
                        <label>Passwort</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Anmelden</button>
                </form>

                <form id="registerForm" class="auth-form" onsubmit="handleRegister(event)">
                    <div class="input-group">
                        <label>Benutzername</label>
                        <input type="text" id="regUsername" required>
                    </div>
                    <div class="input-group">
                        <label>E-Mail</label>
                        <input type="email" id="regEmail" required>
                    </div>
                    <div class="input-group">
                        <label>Passwort</label>
                        <input type="password" id="regPassword" required>
                    </div>
                    <div class="input-group">
                        <label>Klasse/Jahrgangsstufe</label>
                        <select id="regClass">
                            <option value="8">8. Klasse</option>
                            <option value="9">9. Klasse</option>
                            <option value="10">10. Klasse</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Registrieren</button>
                </form>
            </div>

            <div class="fun-fact" id="funFact">
                <span class="fun-fact-label">ğŸ’¡ Wusstest du?</span>
                <p id="funFactText">Die Pyramiden von Gizeh waren Ã¼ber 3.800 Jahre lang die hÃ¶chsten Bauwerke der Welt!</p>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="screen">
        <!-- Sidebar -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">ğŸ‘¤</div>
                    <div class="user-details">
                        <span class="username" id="displayUsername">Benutzer</span>
                        <span class="user-rank" id="displayRank">ğŸŒ¾ TagelÃ¶hner</span>
                    </div>
                </div>
                <div class="user-stats">
                    <div class="stat">
                        <span class="coin-icon">ğŸ„</span>
                        <span id="coinCount">0</span>
                    </div>
                </div>
            </div>

            <div class="nav-menu">
                <button class="nav-item active" data-section="dashboard" onclick="showSection('dashboard')">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Dashboard</span>
                </button>
                <button class="nav-item" data-section="chat" onclick="showSection('chat')">
                    <span class="nav-icon">ğŸ’¬</span>
                    <span class="nav-text">KI-Tutor</span>
                </button>
                <button class="nav-item" data-section="operators" onclick="showSection('operators')">
                    <span class="nav-icon">ğŸ“</span>
                    <span class="nav-text">Operatoren</span>
                </button>
                <button class="nav-item" data-section="strategies" onclick="showSection('strategies')">
                    <span class="nav-icon">ğŸ§ </span>
                    <span class="nav-text">Lernstrategien</span>
                </button>
                <button class="nav-item" data-section="timeline" onclick="showSection('timeline')">
                    <span class="nav-icon">ğŸ“…</span>
                    <span class="nav-text">Zeitstrahl</span>
                </button>
                <button class="nav-item" data-section="exercises" onclick="showSection('exercises')">
                    <span class="nav-icon">ğŸ¯</span>
                    <span class="nav-text">Ãœbungen</span>
                </button>
                <button class="nav-item" data-section="library" onclick="showSection('library')">
                    <span class="nav-icon">ğŸ“š</span>
                    <span class="nav-text">Bibliothek</span>
                </button>
                <button class="nav-item" data-section="castle" onclick="showSection('castle')">
                    <span class="nav-icon">ğŸ°</span>
                    <span class="nav-text">Meine Burg</span>
                </button>
                <button class="nav-item" data-section="settings" onclick="showSection('settings')">
                    <span class="nav-icon">âš™ï¸</span>
                    <span class="nav-text">Einstellungen</span>
                </button>
            </div>

            <div class="sidebar-footer">
                <button class="btn btn-secondary btn-full" onclick="logout()">Abmelden</button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Pomodoro Timer Bar -->
            <div class="timer-bar" id="timerBar">
                <div class="timer-info">
                    <span class="timer-status" id="timerStatus">â¸ï¸ Timer pausiert</span>
                    <span class="timer-display" id="timerDisplay">20:00</span>
                </div>
                <div class="timer-controls">
                    <button class="timer-btn" onclick="startTimer()" id="timerStartBtn">â–¶ï¸ Start</button>
                    <button class="timer-btn" onclick="pauseTimer()" id="timerPauseBtn" style="display:none;">â¸ï¸ Pause</button>
                    <button class="timer-btn" onclick="resetTimer()">ğŸ”„ Reset</button>
                    <button class="timer-btn" onclick="skipBreak()" id="skipBreakBtn" style="display:none;">â­ï¸ Pause Ã¼berspringen</button>
                </div>
                <div class="timer-progress">
                    <div class="timer-progress-bar" id="timerProgressBar"></div>
                </div>
                <div class="session-stats">
                    <span>ğŸ“– Heute gelernt: <strong id="todayLearned">0</strong> Min</span>
                </div>
            </div>

            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <div class="section-header">
                    <h1>Willkommen zurÃ¼ck, <span id="welcomeName">Benutzer</span>!</h1>
                    <p>Setze deine Lernreise fort</p>
                </div>

                <div class="dashboard-grid">
                    <!-- Progress Card -->
                    <div class="card progress-card">
                        <h3>ğŸ“Š Dein Fortschritt</h3>
                        <div class="progress-ring-container">
                            <div class="progress-ring" id="progressRing">
                                <span class="progress-value" id="progressValue">0%</span>
                            </div>
                        </div>
                        <div class="progress-details">
                            <div class="progress-item">
                                <span>Themen abgeschlossen</span>
                                <strong id="topicsCompleted">0/12</strong>
                            </div>
                            <div class="progress-item">
                                <span>Ãœbungen gemacht</span>
                                <strong id="exercisesDone">0</strong>
                            </div>
                        </div>
                    </div>

                    <!-- Rank Card -->
                    <div class="card rank-card">
                        <h3>âš”ï¸ Dein Rang</h3>
                        <div class="rank-display">
                            <div class="rank-icon" id="rankIcon">ğŸŒ¾</div>
                            <div class="rank-name" id="rankName">TagelÃ¶hner</div>
                        </div>
                        <div class="rank-progress">
                            <div class="rank-bar">
                                <div class="rank-bar-fill" id="rankBarFill" style="width: 0%"></div>
                            </div>
                            <span class="rank-next">NÃ¤chster Rang: <span id="nextRank">Bauer</span></span>
                        </div>
                        <div class="coins-display">
                            <span class="coin-big">ğŸ„</span>
                            <span class="coin-amount" id="coinsAmount">0</span>
                            <span class="coin-label">Kuh-MÃ¼nzen</span>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="card quick-actions-card">
                        <h3>ğŸš€ Schnellstart</h3>
                        <div class="quick-actions">
                            <button class="quick-btn" onclick="showSection('chat')">
                                <span class="quick-icon">ğŸ’¬</span>
                                <span>KI-Tutor fragen</span>
                            </button>
                            <button class="quick-btn" onclick="showSection('exercises')">
                                <span class="quick-icon">ğŸ¯</span>
                                <span>Ãœbung starten</span>
                            </button>
                            <button class="quick-btn" onclick="showSection('operators')">
                                <span class="quick-icon">ğŸ“</span>
                                <span>Operatoren Ã¼ben</span>
                            </button>
                            <button class="quick-btn" onclick="showSection('timeline')">
                                <span class="quick-icon">ğŸ“…</span>
                                <span>Zeitstrahl erkunden</span>
                            </button>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="card activity-card">
                        <h3>ğŸ“œ Letzte AktivitÃ¤ten</h3>
                        <div class="activity-list" id="activityList">
                            <div class="activity-item">
                                <span class="activity-icon">ğŸ¯</span>
                                <span class="activity-text">Starte deine erste Ãœbung!</span>
                            </div>
                        </div>
                    </div>

                    <!-- Achievements -->
                    <div class="card achievements-card">
                        <h3>ğŸ† Auszeichnungen</h3>
                        <div class="achievements-grid" id="achievementsGrid">
                            <div class="achievement locked">
                                <span class="achievement-icon">ğŸ”’</span>
                                <span class="achievement-name">Erste Schritte</span>
                            </div>
                            <div class="achievement locked">
                                <span class="achievement-icon">ğŸ”’</span>
                                <span class="achievement-name">Quiz-Meister</span>
                            </div>
                            <div class="achievement locked">
                                <span class="achievement-icon">ğŸ”’</span>
                                <span class="achievement-name">Zeitreisender</span>
                            </div>
                            <div class="achievement locked">
                                <span class="achievement-icon">ğŸ”’</span>
                                <span class="achievement-name">Operator-Pro</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Chat Section -->
            <section id="chat" class="content-section">
                <div class="chat-layout">
                    <div class="chat-main">
                        <div class="chat-header">
                            <h2>ğŸ’¬ KI-Geschichtstutor</h2>
                            <div class="chat-timer">
                                <span>Chat-Zeit: </span>
                                <span id="chatTime">00:00</span>
                            </div>
                        </div>

                        <div class="chat-messages" id="chatMessages">
                            <div class="message ai">
                                <div class="message-avatar">ğŸ¤–</div>
                                <div class="message-content">
                                    <p>Hallo! Ich bin dein KI-Geschichtstutor. Ich helfe dir beim Lernen fÃ¼r Geschichte. Du kannst mich alles fragen oder die Schnell-Buttons unten nutzen!</p>
                                </div>
                            </div>
                        </div>

                        <div class="chat-quick-buttons">
                            <button class="quick-prompt-btn" onclick="sendQuickPrompt('eselsbruecke')">ğŸ´ EselsbrÃ¼cke erstellen</button>
                            <button class="quick-prompt-btn" onclick="sendQuickPrompt('zusammenfassung')">ğŸ“‹ Zusammenfassung</button>
                            <button class="quick-prompt-btn" onclick="sendQuickPrompt('quiz')">â“ Quiz zu Thema</button>
                            <button class="quick-prompt-btn" onclick="sendQuickPrompt('erklaerung')">ğŸ’¡ Einfach erklÃ¤ren</button>
                            <button class="quick-prompt-btn" onclick="sendQuickPrompt('zeitstrahl')">ğŸ“… Zeitliche Einordnung</button>
                            <button class="quick-prompt-btn" onclick="sendQuickPrompt('vergleich')">âš–ï¸ Vergleich erstellen</button>
                            <button class="quick-prompt-btn" onclick="sendQuickPrompt('pruefung')">ğŸ“ PrÃ¼fungsmodus</button>
                        </div>

                        <div class="chat-input-area">
                            <input type="text" id="chatInput" placeholder="Stelle eine Frage zur Geschichte..." onkeypress="if(event.key==='Enter') sendChatMessage()">
                            <button class="btn btn-primary" onclick="sendChatMessage()">Senden</button>
                        </div>
                    </div>

                    <div class="chat-sidebar">
                        <div class="chat-sidebar-section">
                            <h4>ğŸ’¾ Gespeicherte Chats</h4>
                            <div class="saved-chats" id="savedChats">
                                <p class="no-chats">Noch keine Chats gespeichert</p>
                            </div>
                            <button class="btn btn-secondary btn-full" onclick="saveCurrentChat()">Chat speichern</button>
                        </div>
                        <div class="chat-sidebar-section">
                            <h4>âš™ï¸ KI-Modus</h4>
                            <select id="aiMode" onchange="changeAIMode()">
                                <option value="tutor">ğŸ“š Tutor (hilfsbereit)</option>
                                <option value="critic">ğŸ” Kritiker (streng)</option>
                                <option value="discussion">ğŸ’¬ Diskussionspartner</option>
                            </select>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Operators Section -->
            <section id="operators" class="content-section">
                <div class="section-header">
                    <h1>ğŸ“ Operatoren lernen & Ã¼ben</h1>
                    <p>Verstehe und Ã¼be alle Operatoren fÃ¼r den Geschichtsunterricht</p>
                </div>

                <div class="operators-layout">
                    <div class="operators-sidebar">
                        <h3>Anforderungsbereiche</h3>
                        <div class="afb-tabs">
                            <button class="afb-tab active" onclick="showAFB(1)">
                                <span class="afb-badge afb1">AFB I</span>
                                <span>Reproduktion</span>
                            </button>
                            <button class="afb-tab" onclick="showAFB(2)">
                                <span class="afb-badge afb2">AFB II</span>
                                <span>Reorganisation</span>
                            </button>
                            <button class="afb-tab" onclick="showAFB(3)">
                                <span class="afb-badge afb3">AFB III</span>
                                <span>Transfer & Reflexion</span>
                            </button>
                        </div>

                        <div class="operators-list" id="operatorsList">
                            <!-- Filled by JavaScript -->
                        </div>
                    </div>

                    <div class="operators-main">
                        <div class="operator-detail" id="operatorDetail">
                            <div class="operator-header">
                                <h2 id="operatorName">WÃ¤hle einen Operator</h2>
                                <span class="afb-badge" id="operatorAFB">AFB</span>
                            </div>
                            <div class="operator-content">
                                <div class="operator-section">
                                    <h4>ğŸ“– Definition</h4>
                                    <p id="operatorDefinition">Klicke links auf einen Operator, um mehr zu erfahren.</p>
                                </div>
                                <div class="operator-section">
                                    <h4>ğŸ¯ Was wird erwartet?</h4>
                                    <p id="operatorExpectation"></p>
                                </div>
                                <div class="operator-section">
                                    <h4>ğŸ“ Beispiel-Aufgabe</h4>
                                    <p id="operatorExample"></p>
                                </div>
                                <div class="operator-section">
                                    <h4>ğŸ’¡ Tipps</h4>
                                    <ul id="operatorTips"></ul>
                                </div>
                                <div class="operator-section">
                                    <h4>âš ï¸ HÃ¤ufige Fehler</h4>
                                    <ul id="operatorMistakes"></ul>
                                </div>
                            </div>
                            <div class="operator-actions">
                                <button class="btn btn-primary" onclick="startOperatorExercise()">ğŸ¯ Ãœbung starten</button>
                                <button class="btn btn-secondary" onclick="showOperatorQuiz()">â“ Quiz zum Operator</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Learning Strategies Section -->
            <section id="strategies" class="content-section">
                <div class="section-header">
                    <h1>ğŸ§  Lernstrategien</h1>
                    <p>Entdecke effektive Methoden zum Lernen</p>
                </div>

                <div class="strategies-grid" id="strategiesGrid">
                    <!-- Filled by JavaScript -->
                </div>

                <div class="strategy-detail-modal" id="strategyModal">
                    <div class="modal-content">
                        <button class="modal-close" onclick="closeStrategyModal()">Ã—</button>
                        <div id="strategyDetailContent"></div>
                    </div>
                </div>
            </section>

            <!-- Timeline Section -->
            <section id="timeline" class="content-section">
                <div class="section-header">
                    <h1>ğŸ“… Interaktiver Zeitstrahl</h1>
                    <p>Erkunde die Geschichte durch die Zeit</p>
                </div>

                <div class="timeline-controls">
                    <div class="timeline-zoom">
                        <button onclick="zoomTimeline('out')">â–</button>
                        <span id="zoomLevel">100%</span>
                        <button onclick="zoomTimeline('in')">â•</button>
                    </div>
                    <div class="timeline-filter">
                        <select id="timelineEra" onchange="filterTimeline()">
                            <option value="all">Alle Epochen</option>
                            <option value="antike">Antike</option>
                            <option value="mittelalter">Mittelalter</option>
                            <option value="fruehe-neuzeit">FrÃ¼he Neuzeit</option>
                            <option value="19jh">19. Jahrhundert</option>
                            <option value="20jh">20. Jahrhundert</option>
                        </select>
                    </div>
                </div>

                <div class="timeline-container" id="timelineContainer">
                    <div class="timeline-track" id="timelineTrack">
                        <!-- Filled by JavaScript -->
                    </div>
                </div>

                <div class="timeline-detail-panel" id="timelineDetail">
                    <h3 id="eventTitle">WÃ¤hle ein Ereignis</h3>
                    <p id="eventDate"></p>
                    <p id="eventDescription"></p>
                    <button class="btn btn-secondary" onclick="learnMoreEvent()">Mehr erfahren</button>
                </div>
            </section>

            <!-- Exercises Section -->
            <section id="exercises" class="content-section">
                <div class="section-header">
                    <h1>ğŸ¯ Ãœbungen</h1>
                    <p>Teste dein Wissen und verbessere deine FÃ¤higkeiten</p>
                </div>

                <div class="exercises-tabs">
                    <button class="exercise-tab active" onclick="showExerciseType('quiz')">â“ Quiz</button>
                    <button class="exercise-tab" onclick="showExerciseType('operator')">ğŸ“ Operator-Ãœbungen</button>
                    <button class="exercise-tab" onclick="showExerciseType('cognitive')">ğŸ§© Kognitive Ãœbungen</button>
                </div>

                <div class="exercises-content" id="exercisesContent">
                    <!-- Quiz Selection -->
                    <div class="exercise-type active" id="exerciseQuiz">
                        <h3>WÃ¤hle ein Thema fÃ¼r das Quiz</h3>
                        <div class="topic-grid" id="quizTopics">
                            <!-- Filled by JavaScript -->
                        </div>
                    </div>

                    <!-- Operator Exercises -->
                    <div class="exercise-type" id="exerciseOperator">
                        <h3>Operator-Ãœbungen</h3>
                        <div class="operator-exercise-select">
                            <select id="operatorExerciseSelect">
                                <option value="">WÃ¤hle einen Operator...</option>
                            </select>
                            <button class="btn btn-primary" onclick="startOperatorPractice()">Ãœbung starten</button>
                        </div>
                    </div>

                    <!-- Cognitive Exercises -->
                    <div class="exercise-type" id="exerciseCognitive">
                        <h3>Kognitive Ãœbungen</h3>
                        <p>Trainiere dein Gehirn zwischen den Lerneinheiten</p>
                        <div class="cognitive-games">
                            <button class="cognitive-btn" onclick="startCognitiveGame('memory')">
                                <span class="game-icon">ğŸƒ</span>
                                <span class="game-name">Memory</span>
                                <span class="game-desc">Trainiere dein GedÃ¤chtnis</span>
                            </button>
                            <button class="cognitive-btn" onclick="startCognitiveGame('sequence')">
                                <span class="game-icon">ğŸ”¢</span>
                                <span class="game-name">Reihenfolge</span>
                                <span class="game-desc">Bringe Ereignisse in Ordnung</span>
                            </button>
                            <button class="cognitive-btn" onclick="startCognitiveGame('matching')">
                                <span class="game-icon">ğŸ”—</span>
                                <span class="game-name">Zuordnung</span>
                                <span class="game-desc">Verbinde ZusammenhÃ¤nge</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Exercise Area -->
                <div class="exercise-area" id="exerciseArea" style="display: none;">
                    <!-- Dynamic exercise content -->
                </div>
            </section>

            <!-- Library Section -->
            <section id="library" class="content-section">
                <div class="section-header">
                    <h1>ğŸ“š Bibliothek</h1>
                    <p>Deine Lernmaterialien und Fortschritte</p>
                </div>

                <div class="library-layout">
                    <div class="library-sidebar">
                        <h3>ğŸ“ Ordner</h3>
                        <div class="folder-list" id="folderList">
                            <div class="folder-item" onclick="openFolder('alle')">
                                <span>ğŸ“‚</span> Alle Materialien
                            </div>
                            <div class="folder-item" onclick="openFolder('favoriten')">
                                <span>â­</span> Favoriten
                            </div>
                            <div class="folder-item" onclick="openFolder('gelernt')">
                                <span>âœ…</span> Gelernt
                            </div>
                        </div>
                        <button class="btn btn-secondary btn-full" onclick="createFolder()">+ Neuer Ordner</button>
                    </div>

                    <div class="library-main">
                        <div class="library-filters">
                            <input type="text" placeholder="Suchen..." id="librarySearch" onkeyup="searchLibrary()">
                            <select id="libraryFilter" onchange="filterLibrary()">
                                <option value="all">Alle Inhalte</option>
                                <option value="topics">Themen</option>
                                <option value="notes">Notizen</option>
                                <option value="chats">Gespeicherte Chats</option>
                            </select>
                        </div>

                        <div class="library-content" id="libraryContent">
                            <!-- Filled by JavaScript -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Castle Section (Gamification) - 3D Version -->
            <section id="castle" class="content-section" onshow="showCastleSection()">
                <div class="section-header">
                    <h1>ğŸ° Meine Burg</h1>
                    <p>Baue deine mittelalterliche Festung aus! Drehe die Kamera mit der Maus.</p>
                </div>

                <div class="castle-layout-3d">
                    <!-- 3D Burg Ansicht -->
                    <div class="castle-3d-wrapper">
                        <div id="castle3DContainer">
                            <p style="color: var(--text-secondary); text-align: center; padding: 40px;">
                                ğŸ° 3D-Burg wird geladen...
                            </p>
                        </div>

                        <!-- Level Anzeige -->
                        <div class="castle-level-display">
                            <h3 id="castle3DLevel">Level 1</h3>
                            <div class="level-bar">
                                <div class="level-bar-fill" id="castleLevelBar" style="width: 10%"></div>
                            </div>
                        </div>

                        <!-- GebÃ¤ude Info Panel -->
                        <div id="buildingInfoPanel"></div>

                        <!-- Kamera Steuerung -->
                        <div class="camera-controls">
                            <button class="camera-btn" onclick="rotateCameraLeft()" title="Links drehen">â¬…ï¸</button>
                            <button class="camera-btn" onclick="zoomCameraOut()" title="Herauszoomen">â–</button>
                            <button class="camera-btn" onclick="resetCameraView()" title="Ansicht zurÃ¼cksetzen">ğŸ </button>
                            <button class="camera-btn" onclick="zoomCameraIn()" title="Hineinzoomen">â•</button>
                            <button class="camera-btn" onclick="rotateCameraRight()" title="Rechts drehen">â¡ï¸</button>
                        </div>
                    </div>

                    <!-- Burg Info Sidebar -->
                    <div class="castle-sidebar">
                        <!-- Statistiken -->
                        <div class="castle-stats-3d">
                            <div class="stat-card">
                                <span class="stat-value" id="totalBuildings">2</span>
                                <span class="stat-label">GebÃ¤ude</span>
                            </div>
                            <div class="stat-card">
                                <span class="stat-value" id="coinsDisplay">0</span>
                                <span class="stat-label">ğŸ„ MÃ¼nzen</span>
                            </div>
                            <div class="stat-card">
                                <span class="stat-value" id="currentRankDisplay">ğŸŒ¾</span>
                                <span class="stat-label">Rang</span>
                            </div>
                            <div class="stat-card">
                                <span class="stat-value" id="streakDisplay">0</span>
                                <span class="stat-label">ğŸ”¥ Streak</span>
                            </div>
                        </div>

                        <!-- Shop -->
                        <div class="castle-shop-3d" id="castle3DShop">
                            <h3>ğŸ›’ VerfÃ¼gbare GebÃ¤ude</h3>
                            <p style="color: var(--text-secondary);">Wird geladen...</p>
                        </div>

                        <!-- Rang Ãœbersicht -->
                        <div class="rank-info-3d">
                            <h3>âš”ï¸ RÃ¤nge</h3>
                            <div class="ranks-list" id="ranksList">
                                <div class="rank-item current">ğŸŒ¾ TagelÃ¶hner</div>
                                <div class="rank-item">ğŸŒ¾ Bauer</div>
                                <div class="rank-item">ğŸ”¨ Handwerker</div>
                                <div class="rank-item">âš”ï¸ Ritter</div>
                                <div class="rank-item">ğŸ‘‘ Adel</div>
                                <div class="rank-item">âš¡ Legende</div>
                            </div>
                        </div>

                        <!-- Achievements Button -->
                        <button class="btn btn-secondary btn-full" onclick="showAllAchievements()" style="margin-top: 15px;">
                            ğŸ† Alle Auszeichnungen
                        </button>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="content-section">
                <div class="section-header">
                    <h1>âš™ï¸ Einstellungen</h1>
                    <p>Passe die App an deine BedÃ¼rfnisse an</p>
                </div>

                <div class="settings-grid">
                    <div class="settings-card">
                        <h3>ğŸ¨ Erscheinungsbild</h3>
                        <div class="setting-item">
                            <label>Design</label>
                            <select id="themeSelect" onchange="changeTheme()">
                                <option value="light">â˜€ï¸ Hell</option>
                                <option value="dark">ğŸŒ™ Dunkel</option>
                                <option value="sepia">ğŸ“œ Sepia</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>Akzentfarbe</label>
                            <div class="color-options">
                                <button class="color-btn active" style="background: #667eea" onclick="setAccentColor('#667eea')"></button>
                                <button class="color-btn" style="background: #e74c3c" onclick="setAccentColor('#e74c3c')"></button>
                                <button class="color-btn" style="background: #27ae60" onclick="setAccentColor('#27ae60')"></button>
                                <button class="color-btn" style="background: #f39c12" onclick="setAccentColor('#f39c12')"></button>
                                <button class="color-btn" style="background: #9b59b6" onclick="setAccentColor('#9b59b6')"></button>
                            </div>
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3>ğŸ¤– KI-Einstellungen</h3>
                        <div class="setting-item">
                            <label>Standard KI-Modus</label>
                            <select id="defaultAIMode">
                                <option value="tutor">ğŸ“š Tutor (hilfsbereit)</option>
                                <option value="critic">ğŸ” Kritiker (streng)</option>
                                <option value="discussion">ğŸ’¬ Diskussionspartner</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>API-Key</label>
                            <input type="password" id="apiKeyInput" placeholder="Dein API-Key">
                            <button class="btn btn-secondary" onclick="saveApiKey()">Speichern</button>
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3>â±ï¸ Pomodoro-Timer</h3>
                        <div class="setting-item">
                            <label>Lernzeit (Minuten)</label>
                            <input type="number" id="pomodoroWork" value="20" min="5" max="60">
                        </div>
                        <div class="setting-item">
                            <label>Pausenzeit (Minuten)</label>
                            <input type="number" id="pomodoroBreak" value="5" min="1" max="30">
                        </div>
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" id="pomodoroSound" checked>
                                Ton bei Timer-Ende
                            </label>
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3>ğŸ“Š LernprÃ¤ferenzen</h3>
                        <div class="setting-item">
                            <label>Bevorzugte Lernstrategie</label>
                            <select id="prefStrategy">
                                <option value="">Keine PrÃ¤ferenz</option>
                                <option value="visual">Visuell</option>
                                <option value="auditory">Auditiv</option>
                                <option value="kinesthetic">Praktisch</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>Schwierige Operatoren</label>
                            <div id="difficultOperators" class="tag-list">
                                <!-- Filled by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3>ğŸ’¾ Daten</h3>
                        <button class="btn btn-secondary btn-full" onclick="exportData()">ğŸ“¤ Daten exportieren</button>
                        <button class="btn btn-secondary btn-full" onclick="importData()">ğŸ“¥ Daten importieren</button>
                        <button class="btn btn-danger btn-full" onclick="resetProgress()">ğŸ—‘ï¸ Fortschritt zurÃ¼cksetzen</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal for Exercises/Quizzes -->
    <div class="modal" id="exerciseModal">
        <div class="modal-content modal-large">
            <button class="modal-close" onclick="closeExerciseModal()">Ã—</button>
            <div id="exerciseModalContent"></div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="js/data.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/app.js"></script>
    <script src="js/timer.js"></script>
    <script src="js/chat.js"></script>
    <script src="js/operators.js"></script>
    <script src="js/strategies.js"></script>
    <script src="js/timeline.js"></script>
    <script src="js/exercises.js"></script>
    <script src="js/gamification.js"></script>
    <script src="js/castle3d.js"></script>
    <script src="js/admin.js"></script>
</body>
</html>
